---
title: Vue 筆記 4 - computed、methods、watcher
date: 2019-10-05 19:42:49
tags:
  - Vue
categories: 前端
---

computed 有點類似 function，但必須要回傳一個值，比方說會在很多地方使用到 字串反轉的 function 那就可以把他放在 computed 裡面

``` HTML
<div id="example">
  {{ message.split('').reverse().join('') }}
</div>
<script>
var vm = new Vue({
  el: '#example',
  data: {
    message: 'Hello'
  },
  computed: {
    // a computed getter
    reversedMessage: function () {
      // `this` points to the vm instance
      return this.message.split('').reverse().join('')
    }
  }
})
</script>
```

## 那麼 computed 和 method 有甚麼不一樣呢 ? 
用 method 一樣可以呈現字串反轉的功能

``` HTML
<div id="app">
  <h2>直接撰寫在大括號裡面</h2>
  {{ message.split('').reverse().join('') }}

  <h2>撰寫在 computed </h2>
  {{ reversedMessage }}

  <h2>撰寫在 methods </h2>
  {{ reverseMethod() }}

  <h2>計數器 :</h2>
  {{ counter }} 

  <button @click="addCounter()">增加計數器</button>

</div>

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script>
  let app = new Vue({
    el: '#app',
    data: {
      message: 'Hello World',
      counter: 0
    },
    computed: {
      reversedMessage () {
        console.log('執行 computed')
        this.computedCounter++
        return this.message.split('').reverse().join('')
      }
    },
    methods: {
      reverseMethod () {
        console.log('執行 methods')
        return this.message.split('').reverse().join('')
      },
      addCounter () {
        this.counter++
      }
    }
  })
</script>
```

methods 每當畫面重新 render 的時候就會被執行一次，但是 computed 是會被存在快取裡面，如果跟他相依的資料沒有改變的話，他就會拿前一次的資料帶到畫面上


## Watch
watch 一樣可以監聽字串的欄位，用 computed 也有同樣的效果，但是如果要在數值改變的時候去顯示一個對話框，或者去執行某段 ajax 用 watch 就比較適合 

``` JavaScript
var vm = new Vue({
  el: '#demo',
  data: {
    firstName: 'Foo',
    lastName: 'Bar',
    fullName: 'Foo Bar'
  },
  watch: {
    firstName: function (val) {
      this.fullName = val + ' ' + this.lastName
    },
    lastName: function (val) {
      this.fullName = this.firstName + ' ' + val
    }
  }
```

### Computed getter setter 
``` JavaScript
computed: {
  fullName: {
    // getter
    get: function () {
      return this.firstName + ' ' + this.lastName
    },
    // setter
    set: function (newValue) {
      var names = newValue.split(' ')
      this.firstName = names[0]
      this.lastName = names[names.length - 1]
    }
  }
}
```