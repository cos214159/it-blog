---
title: webpack 筆記 (2) - 基本環境建置
date: 2019-09-18 14:29:28
tags: 
  - webpack
categories: 前端
---

## 首先要先進行環境的建立
我們將使用 package.json 來管理我們的專案，所以首先先使用以下指令建立一個 package.json

```
npm init -y
```

然後我們需要安裝 Webpack 的函式庫還有相關的指令介面

```
npm install --save-dev webpack
npm install --save-dev webpack-cli // 這是用來啟用 webpack 的指令介面
```

## Webapck 打包流程
在 Webpack 幫我們打包的時候我們必須要設定一個進入點，這個進入點是一個 JavaScript，會去引入各種不同種類的檔案，包括圖片或 CSS，這是我一開始覺得很奇怪的地方，為什麼會在 JavaScript 引入圖片或 CSS，但是他的做法上就是如此。

我們先來新增一個設定檔 `webpack.config.js` ，這個是 Webpack 預設會去讀的檔案，在這裡面先來寫一些基本的設定

``` JavaScript
const path = require('path');

module.exports = {
  mode: 'development',
  entry: './src/index.js',
  output: {
    filename: 'bundle.js',
    path: path.resolve(__dirname, 'dist')
  }
}
```

以下針對裡面的幾個屬性來做說明 :
* mode
這個是 Webpack 在打包的時候，會需要設定的打包模式，分為 development 和 production，差別在於 production 模式會將我們輸出的檔案壓縮，盡可能讓檔案變小，在伺服器傳送資料時速度會比較快，而 development 模式會盡可能快速的將檔案建置完成，因為是在開發階段，他並不需要將檔案壓縮，可以增加開發效率。

* entry
這個就是進入點，在這個進入點裡面會去引入各種不同的資源檔，包括圖片或 CSS，雖然也可以設定多個進入點，不過目前先將應用單純化，而有一點要提的是 Webpack 預設他只能打包 .js 和 .json 檔案，如果要打包其他類型的檔案像圖片或是 CSS ，必須要安裝額外的 loader，這個會到之後說明。

* output
這個 Webpack 將資源打包之後輸出的設定，filename 指的是打包之後輸出的名稱，path 指的是打包之後輸出的資料夾，這個位置要注意一下，必須使用絕對路徑，而輸出的檔案資料夾名稱，通常會叫 dist 資料夾。

## 檔案結構
![Alt text](https://firebasestorage.googleapis.com/v0/b/it-blog-a274d.appspot.com/o/webpack%20file%20structure.png?alt=media&token=6308a93a-41ba-4635-9bc6-0255bc54d542
)

這個時候如上圖，我在 index.js 也就是進入點引入的三支 JavaScript 檔案，webpack 在看到這樣的檔案結構之後，會將這三支檔案的內容全部整合在一起，並且輸出到 dist 資料夾裡面，這些流程都依賴於剛剛在 webpack.config.js 的設定。

要運行 webpack 的指令可以在 `package.json` 裡面撰寫執行腳本

``` JavaScript
"scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "dev": "webpack"
},
```

然後執行 
```
npm run dev
```

或者是使用 npm 提供的執行指令 npx 
``` JavaScript
npx webpack
```

這兩種方法都可以執行 webpack 但是一般來說開發專案時, 都是會把執行的腳本定義在 package.json 裡面, 不太會直接執行 webpack 指令

最後這些資源打包輸出之後，在 index.html 裡面我們就只需要將這支打包過後的 JavaScript 引入進來就 OK 了

``` HTML
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Document</title>
    </head>
    <body>
        <script src="./dist/bundle.js"></script>
    </body>
</html>
```
