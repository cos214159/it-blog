---
title: Electron - 13 ipcMain 和 ipcRenderer
date: 2020-01-27 22:53:43
tags:
  - Electron
categories: 前端
---

ipcMain 是可以讓我們傳送訊息到 renderer process 或者 browser 視窗上, 也可以接受視窗傳送的訊息, 在 main.js 我們要引入 ipcMain

``` js
const {app, BrowserWindow, ipcMain} = require('electron')
ipcMain.on('channel1', (e, args) => {
  console.log(e, args)
})
```

然後在視窗程式上, 可以使用 `ipcRender` 去發送訊息

``` js
const { ipcRenderer } = require('electron')

document.querySelector('#talk').addEventListener('click', e => {
    ipcRenderer.send('channel1', 'Hello From main window')
})
```

而在主程式上回傳給視窗程式的話, 要使用 `e.sender.send`, sender 是代表視窗程式

``` js
ipcMain.on('channel1', (e, args) => {
  console.log(e, args)
  e.sender.send('收到您的訊息了, 謝謝你')
})
```

以上方法是在接收到視窗的訊息時, 透過事件物件取得視窗的參考, 並且呼叫 send 方法, 但若是想要主動從主程式將訊息傳送給視窗的話, 需要在畫面載入完成時, 才可以傳送

``` js
  mainWindow.webContents.on('did-finish-load', e => {
    mainWindow.webContents.send('channel-x', {
      from: 'Node.js',
      to: 'mainWindow'
    })
  })
```