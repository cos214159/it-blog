---
title: Nuxt 筆記 2 - router, components, layout
date: 2019-11-02 22:24:49
tags:
  - Vue
  - Nuxt
categories: 前端
---

在使用 Vue CLI 建立的專案，建立 router 時會需要增加一個 router.js，在裡面會必須要設定路由的參數，但在 Nuxt.js 提供的方便的功能，可以把在 pages 資料夾裡面定義的 .vue 檔轉成實際的路由，比方說

`index.vue -> /`
`products/index.vue -> /products`
`products/_id.vue -> /products/:id`
`products/_id/detail.vue -> /products/:id/detail`

## nuxt-link & router-link
nuxt-link 是 nuxt 提供用來切換路由的工具，作用跟 router-link 差不多，其用法為

`<nuxt-link to="/"></nuxt-link>`

## router 進入時進行檢查
Nuxt.js 有提供 validate 這個 hook 可以在進入 router 之前進行檢查，需要注意的是最後需要回傳 true 或 false 作為是否能進入這個頁面的依據

``` JavaScript
export default {
  components: {
    Logo
  },
  validate(data) {
    console.log('data = ', data);
    return true
  }
}
</script>
```

## 巢狀路由 nuxt-child
這個功能也功能 `vue-router` 的 router-view 一樣，將共用的內容抽出來，然後針對部分的區塊進行替換, 以下為範例

users.vue
``` JavaScript
<template>
    <div>
        <span>public user content</span>
        <nuxt-child />
    </div>
</template>
```

users/index.vue
``` JavaScript
<template>
    <div>
        <span>child content</span>
    </div>
</template>
```

users/_id/detail
``` JavaScript
<template>
    <div>
        detail content
    </div>
</template>
```
## layout
預設上所有的 page 都會使用 layouts/default.vue 當作共用的容器，如果想要改變使用的模板可以多新增一支 layout 並且在 page 當中引用

users.vue
``` JavaScript
<template>
    <div>
        users layout
        <nuxt />
    </div>
</template>
```

pages/users.vue
``` JavaScript
<template>
    <div>
        <span>public user content</span>
        <nuxt-child />
    </div>
</template>

<script>
export default {
    layout: 'users'
}
</script>
```

除此之外可以新增一支檔案叫 error.vue，當目前進入的頁面不存在時會將這個 component 的內容渲染至畫面上

error.vue
``` JavaScript
<template>
    <div>
        page not exist
    </div>
</template>
```

## 引用 components
在 Nuxt.js 要使用 component 的話有準備一個 components 的資料夾可以存放，那當然可以自己客製化，在 page 裡面要引入的時候，有設定路徑別名 `~` 和 `@` 用來指定 src 資料夾的路徑，所以如果要引用在 components 資料夾的元件時，可以這樣寫

``` JavaScript
import Logo from '~/components/Logo.vue'
```

## 共用的 CSS 樣式
在 .vue 裡面可以設定該頁的樣式只要加上 scope 就會將樣式限制在這一頁

``` JavaScript
<template>
    <div>
        <span>public user content</span>
        <nuxt-child />
    </div>
</template>

<script>
export default {
    layout: 'users'
}
</script>

<style lang="stylus" scoped>
.box {
    width 200px;
    height 200px;
}
</style>
```

另一種是設定全站的樣式，通常會設定在 assets 裡面，如果要將這個樣式加入至專案中的話，要在 nuxt.config.js 裡面的 CSS 或 plugin 當中加入

``` JavaScript
css: [
  '~/assets/style/main.css'
],
```

## 加入額外的字型
如果想要加入額外的字體，可以在 nuxt.config.js 裡面的 head 屬性加入字體連結
``` JavaScript
  head: {
    title: process.env.npm_package_name || '',
    meta: [
      { charset: 'utf-8' },
      { name: 'viewport', content: 'width=device-width, initial-scale=1' },
      { hid: 'description', name: 'description', content: process.env.npm_package_description || '' }
    ],
    link: [
      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }
    ]
  },
```

## 在 .vue 的 style 中引入資源檔
在 style 中引入資源檔要使用 `~` 當作 src 目錄，要注意的是不用加上 slash `/`
``` SCSS

<style lang="scss" scoped>
.box {
    width: 200px;
    height: 200px;
}

.img {
    width: 300px;
    height: 300px;
    background-image: url('~assets/images/images.jpg');
}
</style>
```
