---
title: webpack 筆記 (4) - plugins
date: 2019-09-18 16:15:22
tags: 
  - webpack
categories: 前端
---

plugins 的作用主要是可以讓 Webpack 在打包資源的同時，可以將一些流程更自動化，以下介紹兩個 plugin 的範例，基本上只要有 plugin 的概念在, 往後只需要針對自己的需求找到對應的 plugin 引入就沒問題
***

## clean-webpack-plugin

在之前的範例，我們每次使用以下指令將打包後的結果輸出到 dist 資料夾時，我們必須要先手動將 dist 資料夾刪除，這樣才比較不會跟舊的檔案混在一起。

但是這樣子的過程會需要依賴手動處理，流程上應該要更自動化才對，而 loader 只是讓 Webpack 在打包非 js 的檔案時的工具，並沒有辦法做到這件事情，這個時候我們必須要仰賴 plugins 的幫忙，而自動刪除資料夾這件事情則要安裝以下套件

```
npm install --save-dev clean-webpack-plugin
```

接下來則是我們的設定檔，需要額外在增加一個 plugins 的屬性，該屬性的值與 modules 不同他是一個陣列，我們需要在這個陣列裡面新增 plugin 的物件，只要設定完成之後，在每次打包時，Webpack 會先將 dist 資料夾清空，再將打包好的檔案輸出

``` JavaScript
const path = require('path');
const CleanWebpackPlugin = require('clean-webpack-plugin');
module.exports = {
  mode: 'development',
  entry: './src/index.js',
  output: {
    filename: 'bundle.js',
    path: path.resolve(__dirname, 'dist')
  },
  module: {
    rules: [
      {
        test: /\.css$/,  
        use: ['style-loader', 'css-loader']
      },
      {
        test: /\.(png|jpg|jpeg|svg|gif)$/,
        use: [
          {
            loader: 'file-loader',
            options: {
              name: 'myPrefix.[name].[ext]',
              publicPath: '/dist/images',
              outputPath: 'images/'
            }
          }
        ]
      }
    ]
  },
  plugins: [
    new CleanWebpackPlugin()
  ]
}
```

## html-webpack-plugin
以前的做法都是將檔案打包之後輸出至指定資料夾，並且手動將該檔案引入至 HTML 裡面，這樣的作法也有 plugin 可以自動化，先安裝以下套件

``` 
npm i --save-dev html-webpack-plugin
```

以下是 plugins 設定檔內容

``` JavaScript
const path = require('path');
const CleanWebpackPlugin = require('clean-webpack-plugin');
const HtmlWebpackPlugin = require('html-webpack-plugin');

module.exports = {
  mode: 'development',
  entry: './src/index.js',
  output: {
    filename: 'bundle.js',
    path: path.resolve(__dirname, 'dist')
  },
  module: {
    rules: [
      {
        test: /\.css$/,  
        use: ['style-loader', 'css-loader']
      },
      {
        test: /\.(png|jpg|jpeg|svg|gif)$/,
        use: [
          {
            loader: 'file-loader',
            options: {
              name: 'myPrefix.[name].[ext]',
              publicPath: '/dist/images',
              outputPath: 'images/'
            }
          }
        ]
      }
    ]
  },
  plugins: [
    new CleanWebpackPlugin(),
    new HtmlWebpackPlugin({
      title: '首頁',
      filename: 'index.html',
      template: './index.html'
    })
  ]
}
```

針對 HtmlWebpackPlugin 有傳入一個物件參數

* title
可以設定輸出的 html 的 title 名稱

* filename
輸出的 html 檔案名稱

* template
輸出的 html 模板，之後可以採用如 pug 或 ejs 的方式撰寫會更為方便

這個輸出的檔案預設會引入 Webpack 打包之後的所有檔案，若是想要做多頁式的應用程式，則需要設定多個 HtmlWebpackPlugin 物件

範例程式碼 : https://github.com/cos214159/webpack-tutorial/tree/master/chapter4-plugins