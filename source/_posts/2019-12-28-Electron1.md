---
title: Electron - 1 介紹
date: 2019-12-28 21:19:23
tags:
  - Electron
categories: 前端
---

開發桌上型的應用程式，會分為 Windows、MaxOS、Linux，而在不同的作業系統上開發會需要學習不同的開發環境和不同的程式語言，而 Electron 幫助我們使用 HTML、CSS、JavaScript 去開發跨平台的桌上型應用程式，有一些比較知名的軟體，像 Slack、VSCODE ... 等都是用 Electron 去開發的，

Electron 是由 GitHub 開發的開放原始碼專案，開發者可以用 HTML, CSS 和 JavaScript 打造跨平臺的桌面應用程式。 Electron 將 Chromium 及 Node.js 整合成單一執行環境，並且能打包成 Mac, Windows 及 Linux 應用程式。

Electron 源於 2013 年，並於 2014 年春季開放原始碼。

## 環境設定
Electron 可以在 Windows、MacOS 和 Linux 上運行，而要使用 Electron 需要安裝 Node.js 和 NPM。

### Windows
支援 Windows 7 以上的版本。

### MacOS
支援 maxOS 10.10 以上的版本。

## 第一個 Electron 應用程式
首先先新增一個空資料夾，並且在該資料夾裡面新增 package.json，這裡面會定義相依的相關套件和應用程式資訊，可以透過 `npm init` 去新增。

接下來需要安裝 Electron
```
npm install --save-dev electron
```

新增完之後在 `package.json` 內增加下列結構

``` json
{
  "name": "electron-example",
  "version": "1.0.0",
  "description": "",
  "main": "main.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "start": "electron ."
  },
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "electron": "^7.1.7"
  }
}
```
要注意的是在啟動時的指令，使用的是 `electron .`，而 `"main": "main.js"` 指的是在啟動 electron 時要執行的腳本，如果沒有設定該屬性，預設會執行 `index.js`。

接者在 `main.js` 裡面，貼上以下程式碼，該程式碼為官方文件提供，其中 `app` 為 macOS 專用的模組，而 BrowserWindow 為 Windows 專用模組。

``` js
const { app, BrowserWindow } = require('electron')

// Keep a global reference of the window object, if you don't, the window will
// be closed automatically when the JavaScript object is garbage collected.
let win

function createWindow () {
  // 建立瀏覽器視窗。
  win = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      nodeIntegration: true
    }
  })

  // and load the index.html of the app.
  win.loadFile('index.html')

  // Open the DevTools.
  win.webContents.openDevTools()

  // 視窗關閉時會觸發。
  win.on('closed', () => {
    // 拿掉 window 物件的參照。如果你的應用程式支援多個視窗，
    // 你可能會將它們存成陣列，現在該是時候清除相關的物件了。
    win = null
  })
}


// 當 Electron 完成初始化，並且準備好建立瀏覽器視窗時
// 會呼叫這的方法
// 有些 API 只能在這個事件發生後才能用。
app.on('ready', createWindow)

// 在所有視窗都關閉時結束程式。
app.on('window-all-closed', () => {
  // 在 macOS 中，一般會讓應用程式及選單列繼續留著，
  // 除非使用者按了 Cmd + Q 確定終止它們
  if (process.platform !== 'darwin') {
    app.quit()
  }
})

app.on('activate', () => {
  // 在 macOS 中，一般會在使用者按了 Dock 圖示
  // 且沒有其他視窗開啟的情況下，
  // 重新在應用程式裡建立視窗。
  if (win === null) {
    createWindow()
  }
})

// 你可以在這個檔案中繼續寫應用程式主程序要執行的程式碼。 
// 你也可以將它們放在別的檔案裡，再由這裡 require 進來。
```

最後在 `index.html` 裡面就可以進行版面的配置

``` HTML
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
    <!-- https://electronjs.org/docs/tutorial/security#csp-meta-tag -->
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
  </head>
  <body>
    <h1>Hello World!</h1>
    We are using node <script>document.write(process.versions.node)</script>,
    Chrome <script>document.write(process.versions.chrome)</script>,
    and Electron <script>document.write(process.versions.electron)</script>.
  </body>
</html>
```

然後在執行 `npm start` 就可以看到以下畫面囉 !

## 全域執行
可以在全域環境下安裝 electron

```
npm i -g electron
```

這樣也可以直接使用 electron 指令執行腳本
