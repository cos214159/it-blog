---
title: node.js 筆記 7 - session、cookie
date: 2019-11-01 06:29:57
tags:
  - Node
categories: 前端
---

## cookie 
cookie 是一個儲存在用戶端的小型資料庫大概只有 40k，指某些網站為了辨別用戶身分而儲存在用戶端（Client Side）上的資料（通常經過加密），而在每一次的請求，cookie 都會被加到 request 裡面，後端接收到之後，就可以開始進行驗證。

而後端沒有辦法使用 req 保存登入的資訊，因為在 res 呼叫過後所有 req 的資料都會不見，所以無法保存登入的紀錄。

``` JavaScript
export.postLogin = (req, res, next) => {
  req.isLoggedIn = true;
  res.redirect('/') 
}
```

使用 cookie 紀錄登入狀態，但這種方法會暴露登入的狀態，讓別人很容易就可以操作我們的登入。

``` JavaScript
export.postLogin = (req, res, next) => {
  req.setHeader('Set-Cookie', 'isLoggedIn=true')
  res.redirect('/') 
}
```

除此之外 cookie 也可以加蠻多額外的參數，像 max-age  expires 用來設定過期的時間，Secure 是指 cookie 只能透過 https 去傳送，HttpOnly 是指不能透過 client 的js 去操作 此 cookie 的內容。

## Sessions
session 是儲存在 server 端而這些資料會以一個 id 存在cookie 每次在發出 request 時，這個 sessionid 會被帶進 request 後端接收到之後就會拿這個 id 去驗證使用者。

首先需要去安裝 session 套件