---
title: Electron - 19 preload script
date: 2020-02-13 20:20:38
tags:
  - Electron
categories: 前端
---

前面的章節有提到, 假如在建立視窗的時候, 有加上 `webPreferences: { nodeIntegration: true }` 的設定, 那就代表我們可以在頁面裡面使用 node.js 的語法, 但這也就暴露了讓駭客使用檔案系統的機會

``` js
  mainWindow = new BrowserWindow({
    width: 1000, height: 800,
    webPreferences: { nodeIntegration: true }
  })
```

但是假如不開啟這個設定, 我們也沒有辦法使用 node.js 原生的功能, 而解法就是我們可以預先執行一段 JavaScript 的腳本, 之後在這個腳本裡面定義一些跟 node.js 相關的程式碼, 

``` js
  mainWindow = new BrowserWindow({
    width: 1000, height: 800,
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: false,
      preload: __dirname + '/preload.js'
    }
  })
```

`contextIsolation` 這個參數的意思是在預先執行的腳本上, 如果要調用 window 的話, 沒有辦法使用, 但設定為 false 的話就可以同時調用 node.js 和 window

然後再撰寫 preload.js

``` js
window.versions = {
    node: process.versions.node,
    electron: process.versions.electron
}
```
