---
title: Vue 筆記 2 - Vue 的生命週期
date: 2019-10-05 18:19:28
tags:
  - Vue
categories: 前端
---

這個是 Vue 生命週期示意圖

![Alt text](https://firebasestorage.googleapis.com/v0/b/it-blog-a274d.appspot.com/o/lifecycle.png?alt=media&token=134186f1-b8ec-40cf-afe8-d21f81123888)

來看看以下這個範例

``` HTML
<div id="app">
    <p>outside text</p>
    <h1>標題文字</h1>
    <template>
      <p>I'm text inside the component.</p>
    </template>

    <h2>畫面上的資料</h2>
    <div style="margin-bottom: 10px" ref="message">{{ message }}</div>
    <button class="btn" @click="modifyData()">改變資料</button>

    <h2>counter</h2>
    <div ref="counter">{{ counter }}</div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script>
    let app = new Vue({
      el: '#app',
      data: {
        message: 'Hello World',
        counter: 0
      },
      computed: {
        proppertyMessage () {
          return this.message
        }
      },
      methods: {
        modifyData () {
          console.log('change')
          this.message = 'Hello World modify'
        }
      },
      beforeCreate() {
        // 這個時候資料和事件都沒有建立起來，在這個時候取變數不會得到值
        console.log('[beforeCreate]', this.message, this.proppertyMessage)
      },
      created () {
        // 這個時候資料和事件都已經建立起來，可以在這個時候取用 data 或是 computed，或是執行非同步的事件
        // 但是 template 和 Virtual DOM 還沒有建立起來
        console.log('[created]', this.message, this.proppertyMessage)
        this.message = 'changed message'
        console.log('[created]', this.message, this.proppertyMessage)

        setInterval(() => {
          this.counter++
        }, 1000)
      },
      beforeMount () {
        // 這個 hook 還在初始化和編譯 render function，所以在這個 hook 是還不能取用 DOM 元素
        console.log(`this.$el doesn't exist yet, but it will soon!`)
      },
      mounted () {
        // 這個 hook 我們已經可以操作畫面上的 DOM 元素，template 還有 component 已經 render 到畫面上
        console.log(this.$el.textContent)
      },

      /*  
        Updating : 當資料更新時，會重新 render 畫面，會進入 update 這一個 life cycle，但是必須是當這個資料有在畫面上，才會
                   觸發這個事件
      */  
      beforeUpdate() {
        console.log('[beforeUpdate] 資料即將改變', this.message)
        console.log(+this.$refs['counter'].textContent === this.counter)
      },
      updated() {
        // 更新後會觸發這一個 hook
        console.log('[updated] 資料改變', this.message)
        console.log(+this.$refs['counter'].textContent === this.counter)
      },
    })
  </script>
```

以下來針對每一個 hook 進行講解
在 Vue 的生命週期可以拆分成兩個部分一個是畫面建立時，另外一個是畫面更新時

-- 畫面建立
* beforeCreated () : 這個時候資料和事件都沒有建立起來，在這個時候取變數不會得到值

* created 這個時候資料和事件都已經建立起來，可以在這個時候取用 data 或是 computed，或是執行非同步的事件 ，但是 template 和 Virtual DOM 還沒有建立起來

* beforeMount : 這個 hook 還在初始化和編譯 render function 以及 virtual DOM，所以在這個 hook 是還不能取用 DOM 元素

* mount : 這個 hook 我們已經可以操作畫面上的 DOM 元素，template 還有 component 已經 render 到畫面上

-- 畫面更新
* beforeUpdate : 當畫面重新 render 之前會觸發的 hook
* updated : 畫面重新 render 之後會觸發這個 hook
